
# Manipulating data with dplyr package 
mydf <- read.csv(path2csv,stringsAsFactors = FALSE) # reads the data with strings as factors
dim(mydf) # Gives the number of rows and columns
head(mydf)
library(dplyr)
packageVersion("dplyr") # Checks the package version
cran <- tbl_df(mydf) # Create a table dataframe of dplyr package
rm("mydf") # Removes the older dataframe 
cran # Table dataframe shows a comprehensive wat of showing the data than the 

# Using the select function of dplyr
?select
select(cran, ip_id, package, country)
5:20
select(cran, r_arch:country) #select multiple columns using :
select(cran, country:r_arch) # Reverse order
cran
select(cran,-time) # remove a column
-5:20
x<--(5:20)
select(cran,-(x:size)) # did not get what is this

# Using the Filter finction of dplyr
filter(cran,package=="swirl") # Filter the rows where the package is swirl
filter(cran,r_version=="3.1.1",country=="US") #comma separated for multiple conditions works as and 
?Comparison
filter(cran,country=="IN",r_version <= "3.0.2")
filter(cran, country=="IN" | country=="US")
filter(cran,size > 100500, r_os == "linux-gnu")
filter(cran, !is.na(r_version))

# USing arrange function of dplyr
cran2 <- select(cran,size:ip_id)
arrange(cran2,ip_id) # arranges column ip_id in ascending order
arrange(cran2,desc(ip_id)) #arranges column in descending order
arrange(cran2,package,ip_id) #arrange using 2 columns 
arrange(cran2, country, desc(r_version), ip_id)

# Using mutate function of dplyr
cran3 <- select(cran,ip_id,package,size) 
cran3
mutate(cran3,size_mb =size/2^20) # Mutate will add 1 more column to the output
cran3
mutate(cran3,size_mb=size/2^20,size_gb=size_mb/2^10) # we can use the existed calculted column to fetch data 
mutate(cran3,correct_size=size+1000)

# Using summzrize function of dplyr
summarize(cran, avg_bytes = mean(size)) # collapses the data for the mean of the size 

# Using group_by function of dplyr 
library(dplyr)
cran <- tbl_df(mydf) # load a dataframe as a table dataframe 
rm("mydf")
cran
by_package <- group_by(cran,package)
by_package
summarize(by_package,mean(size))
pack_sum <- summarize(by_package,
                      count = n() , # Total rows of the package
                      unique = n_distinct(ip_id), # Total number of unique downloads for each package 
                      countries = n_distinct(country), # Total number of disctinct countries in which each package was downloaded
                      avg_bytes = mean(size) ) # Average downloaded size of each package 
quantile(pack_sum$count, probs = 0.99) # gives the 99% downloaded packages for the count greater than that we get here 
top_counts <- filter(pack_sum,count > 679)
top_counts
View(top_counts)
top_counts_sorted <- arrange(top_counts,desc(count))
View(top_counts_sorted)
quantile(pack_sum$unique,probs = 0.99)
top_unique<-filter(pack_sum,unique > 465)
View(top_unique)
top_unique_sorted <- arrange(top_unique,desc(unique))
View(top_unique_sorted)
