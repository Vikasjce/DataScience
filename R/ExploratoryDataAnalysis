head(pollution)
dim(pollution)
library(dplyr)
filter(pollution,pm25>12)
summary(pollution$pm25)
ppm <- pollution$pm25
quantile(ppm)

# Boxplot 
boxplot(ppm,col = "blue") # Creates a boxplot 
abline(h=12) # Adds an abline horizontally in the graph at the point 12

# Histogram
hist(ppm,col = "green")
rug(ppm)
low
high
hist(ppm,col = "green",breaks = 100)
rug(ppm)
hist(ppm,col = "green")
abline(v=12,lwd=3)
abline(v = median(ppm), col = "magenta", lwd = 4) 

# Bar Plot
names(pollution)
reg <- table(pollution$region) # gives the count of each value in the column
reg
barplot(reg,col = "wheat",main = "Number of Counties in Each Region")

# Multiple plots 
boxplot(pm25 ~ region, data = pollution, col = "red") # Creates a box plot for groups of 2 Categorical variables
par(mfrow=c(2,1),mar=c(4,4,2,1))  # Creates 2 rows and 1 column partition and graphs are overlayed 
east <- subset(pollution,region == "east")
head(east)
hist(east$pm25,col = 'green')
hist(subset(pollution,region=="west")$pm25, col = "green")

# Scatter plots 
plot(pollution$latitude,pollution$pm25)
with(pollution,plot(latitude,pm25))
abline(h=12,lwd=2,lty=2)
plot(pollution$latitude, pollution$pm25, col = pollution$region) # Plot colour changes with the number of categorical variables 
abline(h=12,lwd=2,lty=2)
par(mfrow = c(1, 2), mar = c(5, 4, 2, 1))
west <- subset(pollution,region == "west")
plot(west$latitude,west$pm25,main =  "West")
plot(east$latitude,east$pm25,main =  "East")

# Graphical Devices in R 
with(faithful,plot(eruptions,waiting)) # Plot the data using scatter plot
title(main = "Old Faithful Geyser data") # Title can be added later to the graph like this 
dev.cur() # Gives the device where the graph is getting plotted
pdf(file = "myplot.pdf") # Opens the PDF device 
with(faithful,plot(eruptions,waiting))
title(main = "Old Faithful Geyser data")
dev.off() # Closes the PDF device
dev.copy(png,file = "geyserplot.png") # Copies from one device to another
dev.off() # Closed the device after the copy

# Plotting Systems 

## Base plotting system 
with(cars,plot(speed,dist)) 
text(mean(cars$speed),max(cars$dist),"SWIRL rules!") # Places the text at the mean of cars speed and max of cars distance 

## Lattice Plotting System 
head(state)
table(state$region)
xyplot(Life.Exp ~ Income | region,data = state,layout=c(4,1)) # Divides the plot on the third Categorical Variable 
xyplot(Life.Exp ~ Income | region,data = state,layout=c(2,2))

## ggplotting system 
head(mpg)
dim(mpg)
table(mpg$model)
qplot(displ,hwy,data = mpg) # Same as the dot 


## Base plotting system in Detail
# Histogram
head(airquality)
range(airquality$Ozone,na.rm = TRUE)
hist(airquality$Ozone) # Histogram of Ozone distribution in the dataset
# Box Plot
table(airquality$Month)
boxplot(Ozone~Month,data = airquality) # Box plot of Ozone on the categorical variable Month
boxplot(Ozone~Month, airquality, xlab="Month", ylab="Ozone(ppb)",col.axis="blue",col.lab="red")
title(main = "Ozone and Wind in New York City")
#Scatter plot
with(airquality,plot(Wind,Ozone))
title(main = "Ozone and Wind in New York City")

# Change the graph settings using Par
length(par()) # Total of 72 settings using Par
names(par()) # Gives the names of these settings 
